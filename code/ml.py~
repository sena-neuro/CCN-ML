# svm is implemented using libsvm
from sklearn.svm import SVC
from sklearn.model_selection import GridSearchCV

# useful for now
def simple_svm(x_train,y_train, x_test, y_test):
	try: 
		svm_model_linear = SVC(kernel = 'linear', C = 1).fit(x_train, y_train) 
		accuracy = svm_model_linear.score(x_test, y_test) 
		return accuracy
	except Exception: 
		print("    Something went wrong! simple_svm() method did not work!\n")


# to be used later
# more complicated but more useful
def improved_svm(X_train, y_train, X_test, y_test, multiclass = False):
    try: 
        param_grid = [
          {'C': [0.1,0.7,0.8,0.9,1], 'kernel': ['linear']},
          {'C': [0.9,1, 1.1], 'gamma': [0.001, 0.0001], 'kernel': ['rbf']}
         ]
        grid_search = GridSearchCV(SVC(), param_grid, cv = 2)
        grid_search.fit(X_train, y_train)
        # to choose best params can use also the method: svc_param_selection()
        #print("    Best parameters: ",grid_search.best_params_)
        return grid_search.best_params_
    except Exception:
        print("    Something went wrong! improved_svm() method did not work!\n")

# NOT USED
def svc_param_selection(X, y, nfolds):
    Cs = [0.001, 0.01, 0.1, 1, 10]
    gammas = [0.001, 0.01, 0.1, 1]
    param_grid = {'C': Cs, 'gamma' : gammas}
    grid_search = GridSearchCV(SVC(kernel='rbf'), param_grid, cv=nfolds)
    grid_search.fit(X, y)
    grid_search.predict()
    grid_search.best_params_
    return grid_search.best_params_


#------------------------------------
# testing
def main():
    x_train = [[1,0,1,0,1],[0,1,0,1,0],[1,0,1,0,1],[0,1,0,1,0],[1,0,1,0,1],[0,1,0,1,0],[1,0,1,0,1],[0,1,0,1,0]]
    x_test  = [[1,0,1,0,1],[1,0,1,0,1]]
    y_train = [1,0,1,0,1,0,1,0]
    y_test  = [1,1]
    
    print("Trying simple_svm()!\n")
    content = simple_svm(x_train,y_train, x_test, y_test)
    if content != None:
        print("    simple_svm() works.\n")
        
    print("Trying improved_svm()!\n")
    content = improved_svm(x_train,y_train, x_test, y_test)
    if content != None:
        print("    improved_svm() works.\n")
        
main()
